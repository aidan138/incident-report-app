<!DOCTYPE html>
<html>
<head>
  <title>Review Incident Report</title>
  <style>
    body { 
      font-family: Arial, sans-serif; 
      margin: 2em; 
      line-height: 1.5;
      color: #333;
    }

    h2 {
      font-size: 1.8em;
      margin-bottom: 0.5em;
      color: #222;
    }

    form { 
      display: flex; 
      flex-direction: column; 
      max-width: 700px; 
    }

    fieldset {
      border: 1px solid #ccc;
      border-radius: 6px;
      padding: 1.2em;
      margin-top: 1.5em;
    }

    legend {
      font-weight: bold;
      padding: 0 0.5em;
      color: #007BFF;
    }

    label { 
      margin-top: 1em; 
      font-weight: bold; 
      display: flex;
      flex-direction: column;
    }

    input, textarea, select { 
      margin-top: 0.4em;
      padding: 0.6em; 
      font-size: 1em; 
      border: 1px solid #ccc; 
      border-radius: 4px; 
    }

    textarea {
      resize: vertical;
    }

    button { 
      margin-top: 2em; 
      padding: 0.8em 1.2em; 
      background: #007BFF; 
      color: white; 
      font-size: 1.1em;
      border: none; 
      border-radius: 4px;
      cursor: pointer; 
      transition: background 0.3s ease;
    }

    button:hover { 
      background: #0056b3; 
    }

    .success { 
      color: green; 
      font-weight: bold;
      margin-bottom: 1em;
    }

    .error { 
      color: red; 
      font-weight: bold;
      margin-bottom: 1em;
    }
  </style>
</head>
<body>
  <h2>Review Incident Report</h2>

  {% if error %}
    <p class="error">{{ error }}</p>
  {% endif %}

  {% if request.query_params.confirmed %}
    <p class="success">âœ… Incident confirmed and sent to manager!</p>
  {% endif %}

  <form method="post" action="{{ request.url.path.rsplit('/', 1)[0] }}/confirm">

    <fieldset>
      <legend>Employee Information</legend>
      <label>Employee Completing Report:
        <input type="text" name="employee_completing_report" value="{{ incident.employee_completing_report or '' }}">
      </label>
      <label>Employee Phone Number:
        <input type="text" name="creator_phone" value="{{ incident.creator_phone or '' }}">
      </label>
    </fieldset>

    <fieldset>
      <legend>Person Involved</legend>
      <label>Name:
        <input type="text" name="person_involved_name" value="{{ incident.person_involved_name or '' }}">
      </label>
      <label>Age:
        <input type="text" name="person_involved_age" value="{{ incident.person_involved_age or '' }}">
      </label>
      <label>Phone Number:
        <input type="text" name="person_involved_phone_number" value="{{ incident.person_involved_phone_number or '' }}">
      </label>
      <label>Guest Of:
        <input type="text" name="person_involved_guest_of" value="{{ incident.person_involved_guest_of or '' }}">
      </label>
      <label>Address:
        <input type="text" name="person_involved_address" value="{{ incident.person_involved_address or '' }}">
      </label>
      <label>If minor, Parent/Guardian:
        <input type="text" name="person_involved_guardian" value="{{ incident.person_involved_guardian or '' }}">
      </label>
    </fieldset>

    <fieldset>
      <legend>Incident Details</legend>
      <label>Date of Incident:
        <input type="text" name="date_of_incident" value="{{ incident.date_of_incident or '' }}">
      </label>
      <label>Time of Incident:
        <input type="text" name="time_of_incident" value="{{ incident.time_of_incident or '' }}">
      </label>
      <label>Facility Name:
        <input type="text" name="facility_name" value="{{ incident.facility_name or '' }}">
      </label>
      <label>Address of Incident:
        <input type="text" name="incident_address" value="{{ incident.incident_address or '' }}">
      </label>
      <label>Employee Involved:
        <input type="text" name="was_employee_involved" value="{{ incident.was_employee_involved or '' }}">
      </label>
      <label>Was Security Contacted?:
        <input type="text" name="was_security_contacted" value="{{ incident.was_security_contacted or '' }}">
      </label>
      <label>Was 911 Called?:
        <input type="text" name="was_law_contacted" value="{{ incident.was_law_contacted or '' }}">
      </label>
      <label>Transported by Ambulance?:
        <input type="text" name="was_transported_ambulance" value="{{ incident.was_transported_ambulance or '' }}">
      </label>
      <label>If yes, to where?:
        <input type="text" name="ambulance_to_where" value="{{ incident.ambulance_to_where or '' }}">
      </label>
      <label>Type of Incident:
        <select name="type_of_incident">
          {% for option in TypeOfIncident %}
          <option value="{{ option.value }}"
            {% if incident.type_of_incident.value == option.value %}selected{% endif %}>
            {{ option.name.replace('_', ' ') }}
          </option>
          {% endfor %}
        </select>
      </label>
      <label>Other Explanation:
        <input type="text" name="incident_other_exp" value="{{ incident.incident_other_exp or '' }}">
      </label>
      <label>Location in Facility:
        <input type="text" name="location_of_incident" value="{{ incident.location_of_incident or '' }}">
      </label>
    </fieldset>

    <fieldset>
      <legend>Medical Information</legend>
      <label>Signs & Symptoms:
        <input type="text" name="signs_symptoms" value="{{ incident.signs_symptoms or '' }}">
      </label>
      <label>Allergies:
        <input type="text" name="allergies" value="{{ incident.allergies or '' }}">
      </label>
      <label>Medications:
        <input type="text" name="medications" value="{{ incident.medications or '' }}">
      </label>
      <label>Past History:
        <input type="text" name="past_history" value="{{ incident.past_history or '' }}">
      </label>
      <label>Last Food/Drink:
        <input type="text" name="last_food_drink" value="{{ incident.last_food_drink or '' }}">
      </label>
    </fieldset>

    <fieldset>
      <legend>Injury Details</legend>
      <label>Events Leading Up:
        <textarea name="events_leading_up">{{ incident.events_leading_up or '' }}</textarea>
      </label>
      <label>Type of Injury:
        <select name="type_of_injury">
          {% for option in TypeOfInjury %}
          <option value="{{ option.value }}"
            {% if incident.type_of_injury.value == option.value %}selected{% endif %}>
            {{ option.name.replace('_', ' ') }}
          </option>
          {% endfor %}
        </select>
      </label>
      <label>Other Explanation:
        <input type="text" name="injury_other_exp" value="{{ incident.injury_other_exp or '' }}">
      </label>
      <label>Body Part Afflicted:
        <input type="text" name="body_part_afflicted" value="{{ incident.body_part_afflicted or '' }}">
      </label>
      <label>Summary:
        <textarea name="incident_summary" rows="8" style="width:100%;">{{ incident.incident_summary or '' }}</textarea>
      </label>
    </fieldset>

    <fieldset>
      <legend>Witness Information</legend>
      <label>Witness Name:
        <input type="text" name="witness" value="{{ incident.witness or '' }}">
      </label>
      <label>Witness Phone Number:
        <input type="text" name="witness_phone" value="{{ incident.witness_phone or '' }}">
      </label>
    </fieldset>

    <button type="submit">Confirm & Submit</button>
  </form>
</body>
</html>
